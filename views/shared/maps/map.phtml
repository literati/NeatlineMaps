<div id="NLtmp" class="themap"></div>
<div id="mappanel" class="olControlEditingToolbar"></div>
<div id="addlayerdialog"></div>
<div id="mappreview"></div>
<?php
$items = get_items(array('type' => neatlinemaps_getMapItemType() ), 200);
$itemnames = array();
$itemids = array();
foreach ($items as $item) {
	array_push($itemnames,item("Dublin Core", "Title", array(), $item));
	array_push($itemids,$item->id);
}
$options = array_combine($itemids,$itemnames);
echo $this->formSelect("layerselect", reset($options), array('class'=>'select'), $options);
?>
</div>

<script type="text/javascript">
		jQuery.noConflict();

		// insert our projection
		<?php print $params['proj4js']; unset($params['proj4js']);?>
		
		var NLconfig = <?php print json_encode($params) . ";\n";?>
		NLconfig.mapdiv = "neatlinemap" + Omeka.NeatlineMaps.history.length;
		document.getElementById('NLtmp').id = NLconfig.mapdiv;
		jQuery(document).ready(function () { Omeka.NeatlineMaps.createMap(NLconfig) && delete(NLconfig);} );	
//-->

</script>
